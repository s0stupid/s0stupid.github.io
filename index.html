<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ACCESS GATE</title>

<style>
body{
    background:black;
    color:white;
    font-family:monospace;
    font-size:18px;
    padding:40px;
}
#output{
    white-space:pre-line;
    margin-bottom:20px;
}
#answer{
    background:black;
    color:white;
    border:1px solid white;
    padding:5px;
    font-family:monospace;
    display:none;
}
#error{
    color:red;
    margin-top:10px;
}
</style>
</head>

<body>

<div id="output"></div>
<input id="answer" type="text" autocomplete="off">
<div id="error"></div>

<script>

const birthday = "0221";

const validNames = [
"r233222",
"shin",
"sin",
"신",
"stupid",
"멍청이"
]; --이런걸 봐서 알정도면 굳이 들어가야 하는걸까?

const output = document.getElementById("output");
const input = document.getElementById("answer");
const error = document.getElementById("error");

function typeLine(text, callback){
    let i = 0;
    const interval = setInterval(function(){

        output.innerHTML += text[i];
        i++;

        if(i >= text.length){
            clearInterval(interval);
            output.innerHTML += "<br>";
            if(callback){
                callback();
            }
        }

    }, 30);
}


function start(){

    typeLine("집에 돌아온걸 환영해", function(){
        typeLine("너라면 내 생일정돈 기억해주리라 생각해", function(){
             typeLine("생일을 입력하세요: (4 글자)", function(){
                            input.style.display = "inline";
                            input.focus();
            });
        });
    });

}

let stage = 0;

input.addEventListener("keydown", function(e){

    if(e.key !== "Enter"){
        return;
    }

    const value = input.value.trim();

    if(stage === 0){

        if(value === birthday){

            error.innerHTML = "";
            output.innerHTML += "> " + value + "<br>";

            stage = 1;

            typeLine(" ", function(){
                typeLine("그래 이런건 기본이겠지 그럼 마지막으로", function(){
                    typeLine("너가 부르던 나의 이름을 알려줘");
                });
            });

        }else{
            error.innerHTML = "ACCESS DENIED";
        }

    }else if(stage === 1){

        const lowerNames = validNames.map(function(n){
            return n.toLowerCase();
        });

        if(lowerNames.includes(value.toLowerCase())){

            error.innerHTML = "";
            output.innerHTML += "> " + value + "<br>";

            typeLine(" ", function(){
                typeLine("ACCESS GRANTED", function(){
                    setTimeout(function(){
                        window.location.href = "main.html";
                    }, 1000);
                });
            });

        }else{
            error.innerHTML = "ACCESS DENIED";
        }

    }

    input.value = "";

});


start();

</script>

</body>
</html>
